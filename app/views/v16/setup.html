{% extends "layout.html" %}

{% block content %}
<div class="govuk-grid-row">
    <div class="govuk-grid-column-full">
        <h1 class="govuk-heading-m">Prototype {{myData.version}} setup</h1>

        <p class="govuk-body" >
              <a href="setup?r=true" class="govuk-link govuk-link--no-visited-state">Reset to default values</a>
          </p>  
        <hr class="govuk-section-break govuk-section-break--m govuk-section-break--visible">
    </div>
</div>
<div class="govuk-grid-row">
    <div class="govuk-grid-column-one-half">

        <h2 class="govuk-heading-l">Applying</h2>

        <!-- Legal agreement -->
        <div class="govuk-form-group legalagreement">
            <div class="govuk-checkboxes">
                <div class="govuk-checkboxes__item">
                <input class="govuk-checkboxes__input" id="legalagreement" name="legalagreement" type="checkbox" value="true" data-option="legalagreement" {% if myData.legalagreement == 'true' %}checked{% endif %}>
                    <label class="govuk-label govuk-checkboxes__label" for="legalagreement">
                        Legal agreement signed
                    </label>
                </div>
            </div>
        </div>

        <!-- Bank details -->
        <div class="govuk-form-group bankdetails">
            <div class="govuk-checkboxes">
                <div class="govuk-checkboxes__item">
                <input class="govuk-checkboxes__input" id="bankdetails" name="bankdetails" type="checkbox" value="true" data-option="bankdetails" {% if myData.bankdetails == 'true' %}checked{% endif %}>
                    <label class="govuk-label govuk-checkboxes__label" for="bankdetails">
                        Bank details added previously
                    </label>
                </div>
            </div>
        </div>

        <!-- Number of apprentices available -->
        <div class="govuk-form-group apprenticesavailable">
            <label class="govuk-label" >
                Number of apprentices available
            </label>
            <select class="govuk-select" style="min-width: 100%" id="apprenticesavailable" name="apprenticesavailable" data-option="apprenticesavailable">
              <option {% if myData.apprenticesavailable == "1" %}selected{% endif %} value="1">1</option>
              <option {% if myData.apprenticesavailable == "6" %}selected{% endif %} value="6">6</option>
              <option {% if myData.apprenticesavailable == "100" %}selected{% endif %} value="100">100</option>
            </select>
        </div>

        <h2 class="govuk-heading-l">Your applications</h2>

        <!-- Apprentices applied for -->
        <div class="govuk-form-group apprenticesapplied">
            <label class="govuk-label" >
                Apprentices applied for
            </label>
            <select class="govuk-select" style="min-width: 100%" id="apprenticesapplied" name="apprenticesapplied" data-option="apprenticesapplied">
              <option {% if myData.apprenticesapplied == "0" %}selected{% endif %} value="0">0</option>
              <option {% if myData.apprenticesapplied == "6" %}selected{% endif %} value="6">6</option>
              <option {% if myData.apprenticesapplied == "100" %}selected{% endif %} value="100">100</option>
            </select>
        </div>

        <!-- VRF -->
        <div class="govuk-form-group vrf">
            <label class="govuk-label" >
                VRF
            </label>
            <select class="govuk-select" style="min-width: 100%" id="vrf" name="vrf" data-option="vrf">
              <option {% if myData.vrf == "added" %}selected{% endif %} value="added">Added</option>
              <option {% if myData.vrf == "notadded" %}selected{% endif %} value="notadded">Not added</option>
              <option {% if myData.vrf == "inprogress" %}selected{% endif %} value="inprogress">In progress</option>
            </select>
        </div>

    </div>

    <div class="govuk-grid-column-one-half" >
        

    </div>
</div>

<div class="govuk-grid-row">
    <div class="govuk-grid-column-full">

        <p class="govuk-body govuk-!-margin-top-6 " id="start-url" style="display:none">
            <a href="#" role="button" draggable="false" class="govuk-button govuk-!-font-size-24">Start prototype</a>
        </p>

        <p class="govuk-body" >
            <span class="govuk-!-font-weight-bold">Shareable link to start prototype:</span><br>
            <span class="govuk-body" id="start-url-label" style="display:none; word-wrap: break-word"></span>
        </p>

        <hr class="govuk-section-break govuk-section-break--xl govuk-section-break--visible">

    </div>
</div>

<div class="govuk-grid-row">
    <div class="govuk-grid-column-full">

        <h2 class="govuk-heading-m">Full page list</h2>
        <table class="govuk-table">

            <tbody class="govuk-table__body">    

                <tr class="govuk-table__row">
                    <th class="govuk-table__cell" colspan="2"> <h2 class="govuk-heading-m govuk-!-margin-top-4">Emails</h2></th>
                </tr>

                <tr class="govuk-table__row">
                    <th class="govuk-table__cell">Application complete</th>
                    <td class="govuk-table__cell" ><a class="govuk-link govuk-link--no-visited-state" href="email/application-complete?r=t">/application-complete</a></td>
                </tr>
                <tr class="govuk-table__row">
                    <th class="govuk-table__cell">Estimated payment</th>
                    <td class="govuk-table__cell" ><a class="govuk-link govuk-link--no-visited-state" href="email/estimated-payment?r=t">/estimated-payment</a></td>
                </tr>
                <tr class="govuk-table__row">
                    <th class="govuk-table__cell">Changed estimated payment</th>
                    <td class="govuk-table__cell" ><a class="govuk-link govuk-link--no-visited-state" href="email/changed-estimated-payment?r=t">/changed-estimated-payment</a></td>
                </tr>
                <tr class="govuk-table__row">
                    <th class="govuk-table__cell">Need bank details</th>
                    <td class="govuk-table__cell" ><a class="govuk-link govuk-link--no-visited-state" href="email/need-bank-details?r=t">/need-bank-details</a></td>
                </tr>
                <tr class="govuk-table__row">
                    <th class="govuk-table__cell">May need bank details</th>
                    <td class="govuk-table__cell" ><a class="govuk-link govuk-link--no-visited-state" href="email/may-need-bank-details?r=t">/may-need-bank-details</a></td>
                </tr>
                <tr class="govuk-table__row">
                    <th class="govuk-table__cell">Skipped bank details</th>
                    <td class="govuk-table__cell" ><a class="govuk-link govuk-link--no-visited-state" href="email/skipped-bank-details?r=t">/skipped-bank-details</a></td>
                </tr>
                <tr class="govuk-table__row">
                    <th class="govuk-table__cell">Remittance</th>
                    <td class="govuk-table__cell" ><a class="govuk-link govuk-link--no-visited-state" href="email/remittance?r=t">/remittance</a></td>
                </tr>
                <tr class="govuk-table__row">
                    <th class="govuk-table__cell">Removed apprentice</th>
                    <td class="govuk-table__cell" ><a class="govuk-link govuk-link--no-visited-state" href="email/removed-apprentice?r=t">/removed-apprentice</a></td>
                </tr>


            </tbody>
        </table>
    </div>
</div>

{% endblock %}

{% block pageScripts %}
<script>
    $(document).ready(function(){

        var _startURL = $("#start-url a"),
            _startURLLabel = $("#start-url-label"),
            _options = $("[data-option]");

        _options.change(function(){
            setValues()
        }).trigger("change");

        //SET VALUES
        function setValues(){
            
            //Base URL
            var _urlBase = "https://das-incentive-pay-prototype.herokuapp.com/" + {{myData.version|dump|safe}} + "/";
            
            //Queries
            var _urlComponents = "",
                _urlReset = "r=t",
                _urlPage = "account-home?",
                _urlLegalAgreement = "&legal=" + ($('input[name=legalagreement]:checked').val() || false),
                _urlBankDetails = "&bank=" + ($('input[name=bankdetails]:checked').val() || false),
                _urlAppAvail = "&apprentices=" + _options.filter("#apprenticesavailable").val(),
                _urlAppApplied = "&applied=" + _options.filter("#apprenticesapplied").val(),
                _urlVRF = "&vrf=" + _options.filter("#vrf").val();

            //Queries combined
            var _urlPageQueries = _urlPage + _urlReset + _urlLegalAgreement + _urlBankDetails + _urlAppAvail + _urlAppApplied + _urlVRF;

            //URL text
            var _startURLText = _urlBase + _urlPageQueries,
                _startURLHREF =  _urlPageQueries;

            // update label
            _startURLLabel
                .text(_startURLText)
                .show()

            //update link
            _startURL
                .attr("href", _startURLHREF)
                .parent().show()
        }

    });
</script>
{% endblock %}